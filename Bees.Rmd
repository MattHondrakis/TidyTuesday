---
title: "Bee Colony"
author: "Matthew"
date: "1/11/2022"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_float: true
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

colony <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/colony.csv')
stressor <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/stressor.csv')

colony$year <- as.numeric(colony$year)

beecolony <- colony %>%
  inner_join(stressor, by = c("year", "months", "state"))

```


# Explore

```{r}
beecolony <- na.omit(beecolony)

beecolony %>%
  select(where(is.numeric)) %>%
  gather() %>%
  ggplot(aes(value)) + geom_histogram() + facet_wrap(~key, scales = "free")

beecolony <- na.omit(beecolony)

beecolony %>%
  group_by(state) %>%
  summarize(sum(colony_lost), sum(colony_added), sum(colony_added)/sum(colony_lost)) %>%
  arrange(-`sum(colony_lost)`, `sum(colony_added)`)
```


```{r}
gplot <- function(x){
  colony %>%
    filter(!is.na({{x}})) %>%
    distinct(months, year, state, {{x}}) %>%
    group_by(months, year, state) %>%
    ggplot(aes({{x}}, fct_reorder(state, {{x}}))) + geom_col() + labs(y = "")
}

gplot(colony_reno)
```

