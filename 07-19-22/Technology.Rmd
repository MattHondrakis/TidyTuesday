---
title: "Technology Adoption"
author: "Matthew"
date: '2022-07-19'
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, dpi = 500)
library(tidyverse)
library(patchwork)
library(scales)
library(lubridate)
library(countrycode)
theme_set(theme_bw())
```


```{r}
technology <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-07-19/technology.csv')

technology <- technology %>% 
  bind_cols(country = countrycode(technology$iso3c, origin = 'iso3c', destination = 'country.name'),
            continent = countrycode(technology$iso3c, origin = 'iso3c', destination = 'continent'))
```


```{r}
skimr::skim(technology)
```



```{r}
technology %>% 
  count(label, sort = TRUE)

technology %>% 
  count(category, sort = TRUE)
```



```{r}
names <- technology %>% 
  filter(category == "Vaccines") %>% 
  count(variable, sort = TRUE) %>% 
  head(5) %>% 
  pull(variable)

technology %>% 
  count(iso3c, sort = TRUE)


technology %>%
  group_by(year) %>% 
  summarize(value = mean(value)) %>% 
  ggplot(aes(year, value)) +
  geom_line() + theme(legend.position = "none")



technology %>%
  filter(variable %in% names) %>% 
  group_by(year) %>% 
  summarize(value = mean(value)) %>% 
  ggplot(aes(year, value)) +
  geom_line() + theme(legend.position = "none")
```



```{r}
technology %>%  
  drop_na() %>% 
  group_by(year, continent) %>% 
  summarize(value = mean(value) + 1) %>% 
  ggplot(aes(year, value, color = fct_reorder(continent, value, max, .desc = TRUE))) + geom_line() +
  scale_y_log10() + scale_x_continuous(breaks = seq(1820, 2020, 20)) + 
  labs(title = "Average Vaccination Rate per Continent over time", color = "")
```





```{r}
technology %>% 
  ggplot(aes(year, value, color = group)) + geom_point() + scale_y_log10()

technology %>% 
  filter(value == 0) %>% 
  group_by(group) %>% 
  summarize(n = n())
```
